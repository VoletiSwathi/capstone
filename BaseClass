package base;

//import java.time.Duration;
import java.util.concurrent.TimeUnit;
import org.openqa.selenium.WebDriver;
import org.openqa.selenium.chrome.ChromeDriver;
import io.github.bonigarcia.wdm.WebDriverManager;

public class BaseClass {

    // ðŸ”´ MAKE IT STATIC so Hooks & Steps share the same driver instance
    protected static WebDriver driver;

    public void launchBrowser() {
        WebDriverManager.chromedriver().setup();
        driver = new ChromeDriver();
        driver.manage().window().maximize();
       // driver.manage().timeouts().implicitlyWait(Duration.ofSeconds(10));
    driver.manage().timeouts().implicitlyWait(10, TimeUnit.SECONDS);
    }

    public void closeBrowser() {
        if (driver != null) {
            driver.quit();
            driver = null;
        }
    }
}


package pages;

import org.openqa.selenium.By;
import org.openqa.selenium.WebDriver;

public class DownloadPage {

    WebDriver driver;

    By headerText = By.xpath("//h1[contains(text(),'Get WordPress')]");

    public DownloadPage(WebDriver driver) {
        this.driver = driver;
    }

    public String getHeaderText() {
        return driver.findElement(headerText).getText();
    }
}



package pages;

import org.openqa.selenium.By;
import org.openqa.selenium.WebDriver;
import org.openqa.selenium.interactions.Actions;

public class HomePage {

    WebDriver driver;

    By extendMenu = By.xpath("//span[text()='Extend']");
    By getWordPressOption = By.xpath("//a[contains(@class,'get-wordpress')]");
    By communityMenu = By.xpath("//span[text()='Community']");
    By photoDirectoryOption = By.xpath("//span[text()='Photo Directory']");

    public HomePage(WebDriver driver) {
        this.driver = driver;
    }

    public String getPageTitle() {
        return driver.getTitle();
    }

    public void clickGetWordPress() {
        Actions actions = new Actions(driver);
        actions.moveToElement(driver.findElement(extendMenu)).perform();
        driver.findElement(getWordPressOption).click();
    }

    public void navigateToPhotoDirectory() {
        driver.findElement(communityMenu).click();
        driver.findElement(photoDirectoryOption).click();
    }
}

package pages;

import org.openqa.selenium.By;
import org.openqa.selenium.WebDriver;

public class PhotoDirectory {

    WebDriver driver;

    By searchBox = By.xpath("//input[@placeholder='Search photos']");
    By searchBtn = By.xpath("(//button[@type='submit'])[2]");
    By images = By.xpath("//ul[contains(@class,'wp-block-post-template')]//li//a");

    public PhotoDirectory(WebDriver driver) {
        this.driver = driver;
    }

    public void searchPhoto(String photo) {
        driver.findElement(searchBox).sendKeys(photo);
        driver.findElement(searchBtn).click();
    }

    public boolean isPhotoDisplayed() {
        return driver.findElements(images).size() > 0;
    }

    // New method to search for "nature" and handle if-else
    public void checkNaturePhoto() {
        searchPhoto("nature"); // search for "nature"

        if (isPhotoDisplayed()) {
            System.out.println("Nature photo is displayed!");
        } else {
            System.out.println("Nature photo is NOT displayed!");
        }
    }
}

package runner;

import io.cucumber.testng.AbstractTestNGCucumberTests;
import io.cucumber.testng.CucumberOptions;

@CucumberOptions(
        features = "src/test/resources/feature",
        glue = {"stepdefinitions","base"},
        plugin = {
                "pretty",
                "html:target/cucumber-reports.html",
                "json:target/cucumber.json"
        },
        monochrome = true,
        dryRun = false
)
public class TestRunner extends AbstractTestNGCucumberTests {
    
}

package stepdefinitions;

import org.testng.Assert;
import base.BaseClass;
import io.cucumber.java.en.Given;
import io.cucumber.java.en.When;
import io.cucumber.java.en.Then;
import pages.DownloadPage;
import pages.HomePage;
import pages.PhotoDirectory;

public class GetWordPressPage extends BaseClass {

    HomePage home;
    DownloadPage download;
    PhotoDirectory photo;

    @Given("I launch {string}")
    public void i_launch_the_application(String url) {
        driver.get(url);
        home = new HomePage(driver);
        download = new DownloadPage(driver);
        photo = new PhotoDirectory(driver);
    }

    @Then("I verify the page title is {string}")
    public void i_verify_the_page_title_is(String expectedTitle) {
        Assert.assertTrue(
            home.getPageTitle().contains(expectedTitle),
            "Actual title: " + home.getPageTitle()
        );
    }

    @When("I navigate to Get WordPress")
    public void i_navigate_to_get_wordpress() {
        home.clickGetWordPress();
    }

    @Then("I verify the header is {string}")
    public void i_verify_the_header_is(String expectedHeader) {
        Assert.assertTrue(
            download.getHeaderText().contains(expectedHeader),
            "Header found: " + download.getHeaderText()
        );
    }

    @When("I navigate to Photo Directory")
    public void i_navigate_to_photo_directory() {
        home.navigateToPhotoDirectory();
    }

    @When("I search for {string}")
    public void i_search_for(String photoName) {
        photo.searchPhoto(photoName);
    }

    @Then("I verify images are displayed")
    public void i_verify_images_are_displayed() {
        Assert.assertTrue(photo.isPhotoDisplayed(), "No images found");
    }
    
}

//package stepdefinitions;
//import base.BaseClass;
//import io.cucumber.java.After;
//import io.cucumber.java.Before;
//public class Hooks extends BaseClass {
   ///@Before
   //public void beforeScenario() {
       //launchBrowser();
   //}
   //@After
   //public void afterScenario() {
      // closeBrowser();
   //}
//}
<?xml version="1.0" encoding="UTF-8"?>
<suite name="CapstoneSuite">
   <test name="CucumberTests">
       <classes>
           <class name="runner.TestRunner"/>
       </classes>
   </test>
</suite>
Feature: WordPress Capstone_Project
 Scenario: Verify WordPress Get WordPress and Photo Directory
   Given I launch "https://wordpress.org/"
   Then I verify the page title is "WordPress.org"
   When I navigate to Get WordPress
   Then I verify the header is "Get WordPress"
   When I navigate to Photo Directory
   And I search for "nature"
   Then I verify images are displayed
<project xmlns="http://maven.apache.org/POM/4.0.0"
        xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
        xsi:schemaLocation="http://maven.apache.org/POM/4.0.0
                            https://maven.apache.org/xsd/maven-4.0.0.xsd">
 <modelVersion>4.0.0</modelVersion>
 <groupId>com.capstone</groupId>
 <artifactId>CapstoneProject</artifactId>
 <version>0.0.1-SNAPSHOT</version>
 <dependencies>
   <!-- Selenium -->
   <dependency>
       <groupId>org.seleniumhq.selenium</groupId>
       <artifactId>selenium-java</artifactId>
       <version>3.141.59</version>
   </dependency>
  
   <!-- WebDriverManager -->
   <dependency>
       <groupId>io.github.bonigarcia</groupId>
       <artifactId>webdrivermanager</artifactId>
       <version>5.6.3</version>
   </dependency>
  
   <!-- TestNG -->
   <dependency>
       <groupId>org.testng</groupId>
       <artifactId>testng</artifactId>
       <version>7.4.0</version>
       <scope>test</scope>
   </dependency>
  
   <!-- Cucumber Java -->
   <dependency>
       <groupId>io.cucumber</groupId>
       <artifactId>cucumber-java</artifactId>
       <version>6.11.0</version>
       <scope>test</scope>
   </dependency>
  
   <!-- Cucumber TestNG -->
   <dependency>
       <groupId>io.cucumber</groupId>
       <artifactId>cucumber-testng</artifactId>
       <version>6.11.0</version>
       <scope>test</scope>
   </dependency>
   <!-- SLF4J for logging -->
   <dependency>
       <groupId>org.slf4j</groupId>
       <artifactId>slf4j-simple</artifactId>
       <version>1.7.36</version>
   </dependency>
 </dependencies>
 <build>
   <plugins>
     <plugin>
         <groupId>org.apache.maven.plugins</groupId>
         <artifactId>maven-surefire-plugin</artifactId>
         <version>3.0.0-M7</version>
         <configuration>
             <includes>
                 <include>**/TestRunner.java</include>
             </includes>
         </configuration>
     </plugin>
   </plugins>
 </build>
</project>


// 1. Status code is 200
pm.test("Status code is 200", function () {
    pm.response.to.have.status(200);
});

// 2. Response time is acceptable
pm.test("Response time is under 2000ms", function () {
    pm.expect(pm.response.responseTime).to.be.below(2000);
});

// 3. Response is valid JSON array
pm.test("Response is a non-empty JSON array", function () {
    const jsonData = pm.response.json();
    pm.expect(jsonData).to.be.an("array").that.is.not.empty;
});

// 4. Each item has required fields
pm.test("Each country has name, region, and subregion", function () {
    const jsonData = pm.response.json();
    jsonData.forEach(country => {
        pm.expect(country.name.common).to.exist;
        pm.expect(country.region).to.be.a("string");
        pm.expect(country.subregion).to.be.a("string");
    });
});

// 5. Subregion matches the request parameter
pm.test("Subregion matches requested subregion", function () {
    const jsonData = pm.response.json();
    const expectedSubregion = pm.variables.get("subregion");
    jsonData.forEach(country => {
        pm.expect(country.subregion).to.eql(expectedSubregion);
    });
});

def filePath = "C:/Users/tejasrimadas/Downloads/CS.csv"

new File(filePath).eachLine { line, index ->
    if (index > 1) {
        log.info "Value = " + line
    }
}


def filePath = "C:/Users/tejasrimadas/Downloads/CS.csv"

def file = new File(filePath)

def restStep = testRunner.testCase.getTestStepByName("Subregion 1 - Request 1")

file.eachLine { line, index ->
    if (index > 1) {                 
        log.info "Calling API for: " + line

        
        context.testCase.setPropertyValue("subregion", line.trim())

       
        testRunner.runTestStep(restStep)
    }
}


